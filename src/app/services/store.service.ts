import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable, Subject, Subscriber } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class StoreService {

  private store: Subject<Store> = new Subject<Store>();
  products: Product[];
  categories: Category[];
  // url = 'https://produtos-server.herokuapp.com/';
  url = 'http://localhost:9000/';
  options = {
    headers: {
      'authorization': 't5b3b9a5',
      'Access-Control-Allow-Origin': '*'
    }
  };

  constructor(
    private http: HttpClient,
  ) {
/*     this.store = {
      title: 'Doçuras da Nick',
      logo: 'https://scontent.fpoa11-1.fna.fbcdn.net/v/t1.0-9/104841876_102569048186490_8577872177362638693_o.jpg?_nc_cat=109&_nc_sid=09cbfe&_nc_ohc=rR6KLcp4v_oAX9EJhvH&_nc_ht=scontent.fpoa11-1.fna&oh=744f98c3e95717945ba9ad2ad404ad1b&oe=5F5942C2',
      slogan: 'Você merece adoçar a sua vida ❤',
      phone: '51 998446478',
      whatsapp: 'https://wa.me/5551998446478',
      fb: 'https://www.facebook.com/Do%C3%A7uras-da-Nick-102567374853324',
      insta: 'https://www.instagram.com/nickdocurasda/',
      email: 'nicolelopes7777@gmail.com',
      address: 'Núcleo F-49, 59, Aços Finos Piratini - Charqueadas, RS',
      map: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d864.1276877082491!2d-51.611616970780524!3d-29.964748337026233!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x951bc144e0420b7b%3A0xf76269ba228bc30f!2sN%C3%BAcleo%20F-49%2C%2059%20-%20Vila%20Acos%20Finos%20Piratini%2C%20Charqueadas%20-%20RS%2C%2096745-000!5e0!3m2!1spt-BR!2sbr!4v1597266639560!5m2!1spt-BR!2sbr',
      directions: 'https://www.google.com/maps/dir//N%C3%BAcleo+F-49,+59+-+Vila+Acos+Finos+Piratini,+Charqueadas+-+RS,+96745-000/@-29.9647483,-51.611617,19z/data=!4m8!4m7!1m0!1m5!1m1!1s0x951bc144e0420b7b:0xf76269ba228bc30f!2m2!1d-51.6110698!2d-29.9647495',
      payments: [{
        name: 'Dinheiro',
        icon: '<i-dollar-sign></i-dollar-sign>'
      }],
      ship: 0,
    }; */
    this.store.next({
      color: 'blue',
      ownerUid: '',
      code: 'exemplo',
      title: 'Sua Loja',
      logo: 'https://180solucoes.com.br/wp-content/uploads/2020/08/sua-logo-aqui.png',
      favicon: 'https://www.supercopac.com.br/favicon.ico',
      slogan: 'Seu slogan ou lema aqui...',
      phone: '00 00000000',
      whatsapp: 'https://wa.me/',
      fb: 'https://www.facebook.com/',
      insta: 'https://www.instagram.com/',
      email: 'sualoja@email.com',
      address: [{
        street: 'Rua exemplo',
        number: '0',
        district: 'Bairro',
        city: 'Porto Alegre',
        state: 'RS',
        name: 'Filial 1',
        zipCode: '90030-000',
        reference: '',
        complement: ''
      }],
      map: 'https://www.google.com/maps/embed?',
      directions: 'https://www.google.com/maps/dir/',
      payments: [],
      ship: [],
      categories: []
      //  {
      //   name: 'Todos',
      //   icon: `<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open">
      //   <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
      //   <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      // </svg>`
      // }, {
      //   name: 'Bolos',
      //   icon: `<svg viewBox="0 0 335.314 335.314" height="36px" width="36px" style="fill: currentColor;">
      //   <g>
      //     <g>
      //       <path d="M284.536,70.198c-31.343-17.338-72.852-26.887-116.88-26.887S82.119,52.86,50.777,70.198
      //         C18.033,88.312,0,112.891,0,139.409c0,0.012,0.002,0.022,0.002,0.033c0,0.014-0.002,0.027-0.002,0.042l0.569,56.419
      //         c-0.172,16.934,7.273,33.509,21.536,47.938c29.364,29.707,85.137,48.162,145.553,48.162c44.028,0,85.536-9.549,116.879-26.887
      //         c32.744-18.114,50.777-42.694,50.777-69.211v-56.497C335.314,112.891,317.281,88.312,284.536,70.198z M58.039,83.323
      //         c29.156-16.129,68.086-25.012,109.617-25.012c41.531,0,80.461,8.883,109.618,25.013c27.755,15.353,43.04,35.271,43.04,56.085
      //         v29.174c-0.807,11.729-1.542,21.048-15.515,31.44c-15.324,9.083-25.153,6.272-37.574,2.724
      //         c-10.619-3.036-22.647-6.472-37.975-1.311c-15.917,3.988-23.686,13.391-30.548,21.692c-7.689,9.304-13.771,16.663-31.057,17.472
      //         c-17.287-0.811-23.369-8.171-31.058-17.475c-6.861-8.302-14.632-17.705-30.549-21.695c-15.325-5.161-27.351-1.726-37.97,1.309
      //         c-12.422,3.55-22.248,6.355-37.568-2.724c-12.491-9.294-14.313-17.724-15.162-26.956l-0.339-33.674
      //         C15.012,118.581,30.295,98.67,58.039,83.323z M277.275,251.991c-29.156,16.13-68.086,25.013-109.617,25.013
      //         c-56.552,0-108.237-16.748-134.885-43.707c-7.768-7.858-12.916-16.101-15.424-24.617c1.565,1.773,4.932,3.898,5.133,4.019
      //         c21.076,12.645,36.289,8.299,49.708,4.464c9.808-2.804,18.277-5.223,29.3-1.436c0.216,0.074,0.436,0.139,0.658,0.193
      //         c11.308,2.762,16.67,9.249,22.878,16.762c8.484,10.267,18.101,21.903,42.305,22.92c0.105,0.005,0.21,0.007,0.314,0.007
      //         c0.105,0,0.209-0.002,0.314-0.007c24.202-1.014,33.819-12.65,42.305-22.916c6.209-7.512,11.57-13.999,22.877-16.76
      //         c0.223-0.055,0.442-0.119,0.659-0.193c11.021-3.79,19.494-1.366,29.304,1.437c13.423,3.837,28.636,8.183,49.715-4.463
      //         c0.201-0.121,3.416-2.106,5.695-4.523C313.735,224.456,299.513,239.689,277.275,251.991z"/>
      //       <path d="M242.172,138.206c0-10.611-8.62-20.007-24.271-26.454c-13.543-5.579-31.387-8.651-50.244-8.651s-36.7,3.072-50.242,8.651
      //         c-15.651,6.447-24.271,15.843-24.271,26.454c0,10.612,8.62,20.007,24.271,26.455c13.542,5.578,31.385,8.65,50.242,8.65
      //         c18.858,0,36.702-3.072,50.244-8.65C233.552,158.212,242.172,148.818,242.172,138.206z M167.656,118.1
      //         c35.778,0,59.516,12.102,59.516,20.105c0,2.191-2.163,5.543-7.777,8.985c-13.573-5.919-32.278-9.3-51.738-9.3
      //         c-19.459,0-38.163,3.381-51.738,9.299c-5.612-3.441-7.775-6.793-7.775-8.984C108.143,130.202,131.879,118.1,167.656,118.1z
      //          M139.406,155.606c8.635-1.762,18.289-2.715,28.25-2.715c9.961,0,19.615,0.953,28.25,2.716c-8.624,1.765-18.236,2.704-28.25,2.704
      //         C157.642,158.311,148.03,157.372,139.406,155.606z"/>
      //       <path d="M93.162,104.497c1.293,0,2.604-0.335,3.799-1.038l21.076-12.411c3.569-2.102,4.759-6.699,2.657-10.269
      //         c-2.102-3.567-6.697-4.757-10.269-2.657L89.35,90.533c-3.569,2.102-4.759,6.699-2.657,10.269
      //         C88.091,103.175,90.593,104.497,93.162,104.497z"/>
      //       <path d="M176.768,185.015l-23.119,7.983c-3.915,1.352-5.993,5.622-4.641,9.537c1.071,3.105,3.979,5.054,7.089,5.054
      //         c0.812,0,1.638-0.133,2.448-0.413l23.119-7.983c3.915-1.352,5.993-5.622,4.641-9.537
      //         C184.954,185.742,180.684,183.661,176.768,185.015z"/>
      //       <path d="M150.556,82.928l23.083,8.092c0.821,0.287,1.658,0.424,2.482,0.424c3.097,0,5.995-1.933,7.078-5.021
      //         c1.37-3.909-0.688-8.188-4.597-9.56l-23.083-8.092c-3.911-1.369-8.189,0.688-9.559,4.597
      //         C144.589,77.278,146.647,81.557,150.556,82.928z"/>
      //       <path d="M123.44,177.651l-23.083-8.092c-3.912-1.368-8.188,0.688-9.56,4.597c-1.37,3.909,0.688,8.188,4.597,9.559l23.083,8.092
      //         c0.821,0.287,1.658,0.424,2.481,0.424c3.097,0,5.995-1.933,7.078-5.021C129.407,183.301,127.349,179.022,123.44,177.651z"/>
      //       <path d="M263.82,150.81c-3.99,1.11-6.325,5.246-5.215,9.236c0.924,3.318,3.938,5.491,7.222,5.491c0.665,0,1.342-0.09,2.015-0.276
      //         l23.564-6.558c3.99-1.11,6.325-5.246,5.215-9.236c-1.11-3.991-5.241-6.326-9.236-5.215L263.82,150.81z"/>
      //       <path d="M42.652,170.114c1.159,0,2.335-0.27,3.435-0.838l21.733-11.222c3.681-1.9,5.124-6.425,3.224-10.104
      //         c-1.901-3.683-6.429-5.125-10.104-3.224l-21.733,11.222c-3.681,1.9-5.124,6.425-3.224,10.104
      //         C37.314,168.633,39.937,170.114,42.652,170.114z"/>
      //       <path d="M46.199,123.239c0.098,0,0.195-0.002,0.294-0.006l24.442-0.941c4.139-0.159,7.365-3.644,7.205-7.783
      //         c-0.158-4.139-3.621-7.346-7.783-7.205l-24.442,0.941c-4.139,0.159-7.365,3.644-7.205,7.783
      //         C38.865,120.068,42.19,123.239,46.199,123.239z"/>
      //       <path d="M256.06,119.909l23.867,5.355c0.553,0.124,1.104,0.184,1.648,0.184c3.432,0,6.528-2.371,7.312-5.86
      //         c0.906-4.041-1.635-8.053-5.677-8.96l-23.867-5.355c-4.037-0.901-8.052,1.635-8.96,5.677
      //         C249.477,114.99,252.018,119.002,256.06,119.909z"/>
      //       <path d="M217.933,173.188c-4.113-0.16-7.613,3.091-7.76,7.23c-0.146,4.14,3.091,7.614,7.23,7.76l24.445,0.863
      //         c0.09,0.003,0.18,0.005,0.27,0.005c4.02,0,7.348-3.186,7.49-7.235c0.146-4.14-3.091-7.614-7.23-7.76L217.933,173.188z"/>
      //       <path d="M213.258,99.925c0.669,0,1.35-0.091,2.026-0.279l23.556-6.595c3.988-1.117,6.316-5.256,5.2-9.245
      //         c-1.117-3.987-5.255-6.314-9.244-5.2l-23.557,6.595c-3.988,1.117-6.316,5.256-5.2,9.245
      //         C206.967,97.758,209.979,99.925,213.258,99.925z"/>
      //     </g>
      //   </g>
      //   </svg>`
      // },
      // {
      //   name: 'Bebidas',
      //   // icon: `<svg viewBox="0 0 335.314 335.314" height="36px" width="36px" style="fill: currentColor;">
      //   icon: `
      //   <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 512 512" width="36" height="36" style="fill: currentColor;">
      //     <path d="M240,146.087V224H120a8,8,0,0,0-8,8v30.111L96.845,292.422A7.994,7.994,0,0,0,96,296V456a7.994,7.994,0,0,0,.845,3.578l16,32A8,8,0,0,0,120,496H248a8,8,0,0,0,7.155-4.422l.148-.3a31.942,31.942,0,0,0,41.586-7.19C304.228,491.351,315.448,496,328,496s23.772-4.649,31.111-11.908A31.988,31.988,0,0,0,416,464c0-.167,0-.333-.016-.5l-7.948-127.182,7.883-55.188A7.962,7.962,0,0,0,415.99,280H416V146.087a39.8,39.8,0,0,0-7.231-22.939L367.365,64H368a8,8,0,0,0,8-8V40a24.027,24.027,0,0,0-24-24H304a24.027,24.027,0,0,0-24,24V56a8,8,0,0,0,8,8h.635l-41.4,59.148A39.8,39.8,0,0,0,240,146.087ZM112,448V304h64.889C184.8,324.429,192,346.041,192,368c0,35.8-10.951,56.8-24.065,80Zm82.009-144h14.88C216.8,324.429,224,346.041,224,368c0,35.8-10.951,56.8-24.065,80H186.252C198.108,426.3,208,403.57,208,368,208,345.517,201.565,324.168,194.009,304Zm49.047,176H124.944l-8-16H251.056ZM384,480a16.019,16.019,0,0,1-16-16,8,8,0,0,0-16,0c0,8.673-10.991,16-24,16s-24-7.327-24-16a8,8,0,0,0-16,0,15.993,15.993,0,0,1-25.492,12.873l8.647-17.3A7.994,7.994,0,0,0,272,456V296a7.994,7.994,0,0,0-.845-3.578L268.944,288H398.776l-6.695,46.869a7.866,7.866,0,0,0-.065,1.63L400,464.225A16.019,16.019,0,0,1,384,480ZM296,40a8.009,8.009,0,0,1,8-8h48a8.009,8.009,0,0,1,8,8v8H296ZM256,146.087a23.884,23.884,0,0,1,4.338-13.763L308.165,64h39.67l47.827,68.324A23.884,23.884,0,0,1,400,146.087V160H256ZM256,232V176H400v96H260.944L256,262.111Zm0,216H218.252C230.108,426.3,240,403.57,240,368c0-22.483-6.435-43.832-13.991-64H256ZM116.944,288l8-16H200a8,8,0,0,0,0-16H128V240H240v16h-8a8,8,0,0,0,0,16h11.056l8,16Z"/>
      //   </svg>`
      // }]
    });
  }

  getProducts() {
    this.products = [
      {
        cod: '0',
        store: 'askjdhajsdfkjsdjkfk',
        category: 'Bolos',
        name: 'Bolo de Cenoura',
        imgs: ['https://statics.angeloni.com.br/super/files/produtos/3805514/3805514_1_zoom.jpg'],
        sizes: [ {
          name: 'Grande',
          value: 15
        } ],
        unity: 'Tamanho',
        extras: [{
          name: 'Cobertura Dupla',
          value: 5
        },
        {
          name: 'Açucar Light',
          value: 5
        }],
        optional: ['Granulado', 'Cobertura']
      },
      {
        cod: '1',
        store: 'askjdhajsdfkjsdjkfk',
        category: 'Bolos',
        name: 'Bolo de Milho',
        imgs: ['https://statics.angeloni.com.br/super/files/produtos/1310993/1310993_1_zoom.jpg'],
        sizes: [{
          name: 'Grande',
          value: 15
        }, {
          name: 'Gigante',
          value: 20
        }],
        unity: 'Tamanho',
        extras: [{
          name: 'Cobertura Dupla',
          value: 5
        },
        {
          name: 'Açucar Light',
          value: 5
        }],
        optional: ['Granulado', 'Cobertura']
      },
      {
        cod: '2',
        store: 'askjdhajsdfkjsdjkfk',
        category: 'Bebidas',
        name: 'Refri Pepsi 2LT',
        imgs: ['https://www.redeultramercado.com.br/redeultramercado/fotos/g341650.jpg'],
        sizes: [ {
          name: '2LT',
          value: 4.99
        } ],
        unity: 'Tamanho',
        extras: [{
          name: 'Gelado',
          value: 0.5
        }],
        optional: []
      }
    ];

    return this.products;
  }

  async getProduct(cod: string): Promise<Product> {
    return await this.getProducts().find(prod => prod.cod === cod);
  }

  getStore() {
    return this.store.asObservable();
  }

  loadStore(code: string) {
    const apiResp = this.http.get<Store>(this.url + 'store/' + code, this.options);

    apiResp.subscribe(resp => {
      this.store.next(resp);
    }, error =>
      console.log(error)
    );
    // }, error => window.location.href = 'https://copac.produtos.app');
    return apiResp;
  }

}
